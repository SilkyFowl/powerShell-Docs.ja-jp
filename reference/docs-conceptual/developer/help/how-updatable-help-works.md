---
title: 更新可能なヘルプのしくみ
ms.date: 09/13/2016
ms.openlocfilehash: 4849ce81e31171c6822a9078a77ebb45729185a3
ms.sourcegitcommit: de59ff77c6535fc772c1e327b3c823295eaed6ea
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/22/2020
ms.locfileid: "86893290"
---
# <a name="how-updatable-help-works"></a><span data-ttu-id="9f9ce-102">更新可能なヘルプのしくみ</span><span class="sxs-lookup"><span data-stu-id="9f9ce-102">How Updatable Help Works</span></span>

<span data-ttu-id="9f9ce-103">このトピックでは、更新可能なヘルプが各モジュールの HelpInfo XML ファイルと CAB ファイルを処理し、ユーザーの更新されたヘルプをインストールする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-103">This topic explains how Updatable Help processes the HelpInfo XML file and CAB files for each module, and installs updated help for users.</span></span>

## <a name="the-update-help-process"></a><span data-ttu-id="9f9ce-104">Update-help プロセス</span><span class="sxs-lookup"><span data-stu-id="9f9ce-104">The Update-Help Process</span></span>

<span data-ttu-id="9f9ce-105">次の一覧では、ユーザーが特定の UI カルチャのモジュールのヘルプファイルを更新するコマンドを実行したとき[の update-help コマンドレットの](/powershell/module/Microsoft.PowerShell.Core/Update-Help)動作について説明します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-105">The following list describes the actions of the [Update-Help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) cmdlet when a user runs a command to update the help files for a module in a particular UI culture.</span></span>

1. <span data-ttu-id="9f9ce-106">`Update-Help`モジュールマニフェストの**Helpinfouri**キーの値によって指定された場所からリモートの HelpInfo XML ファイルを取得し、スキーマに対してファイルを検証します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-106">`Update-Help` gets the remote HelpInfo XML file from the location specified by the value of the **HelpInfoURI** key in the module manifest and validates the file against the schema.</span></span> <span data-ttu-id="9f9ce-107">(スキーマを表示するには、「 [HELPINFO XML schema](./helpinfo-xml-schema.md)」を参照してください)。は、 `Update-Help` ユーザーのコンピューターのモジュールディレクトリにあるモジュールのローカル HELPINFO XML ファイルを検索します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-107">(To view the schema, see [HelpInfo XML Schema](./helpinfo-xml-schema.md).) Then `Update-Help` looks for a local HelpInfo XML file for the module in the module directory on the user's computer.</span></span>

1. <span data-ttu-id="9f9ce-108">`Update-Help`モジュールのリモートおよびローカルの HelpInfo XML ファイル内にある、指定した UI カルチャのヘルプファイルのバージョン番号を比較します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-108">`Update-Help` compares the version number of the help files for the specified UI culture in the remote and local HelpInfo XML files for the module.</span></span> <span data-ttu-id="9f9ce-109">リモートファイルのバージョン番号がローカルファイルのバージョン番号よりも大きい場合、またはモジュールのローカル HelpInfo XML ファイルがない場合は、によって `Update-Help` 新しいヘルプファイルのダウンロードが準備されます。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-109">If the version number on the remote file is greater than version number on the local file, or if the there is no local HelpInfo XML file for the module, `Update-Help` prepares to download new help files.</span></span>

1. <span data-ttu-id="9f9ce-110">`Update-Help`リモート HelpInfo XML ファイルの**Helpcontenturi**要素によって指定された場所からモジュールの CAB ファイルを選択します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-110">`Update-Help` selects the CAB file for the module from the location specified by the **HelpContentUri** element in the remote HelpInfo XML file.</span></span> <span data-ttu-id="9f9ce-111">モジュール名、モジュール GUID、および UI カルチャを使用して、CAB ファイルを識別します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-111">It uses the module name, module GUID, and UI culture to identify the CAB file.</span></span>

1. <span data-ttu-id="9f9ce-112">`Update-Help`CAB ファイルをダウンロードしてアンパックし、ヘルプコンテンツファイルを検証して、ヘルプコンテンツファイルをユーザーのコンピューターのモジュールディレクトリの言語固有のサブディレクトリに保存します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-112">`Update-Help` downloads the CAB file, unpacks it, validates the help content files, and saves the help content files in the language-specific subdirectory of the module directory on the user's computer.</span></span>

1. <span data-ttu-id="9f9ce-113">`Update-Help`リモートの HelpInfo XML ファイルをコピーすることによって、ローカルの HelpInfo XML ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-113">`Update-Help` creates a local HelpInfo XML file by copying the remote HelpInfo XML file.</span></span> <span data-ttu-id="9f9ce-114">ローカルの HelpInfo XML ファイルを編集して、インストールした CAB ファイルの要素のみが含まれるようにします。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-114">It edits the local HelpInfo XML file so that it includes elements only for the CAB file that it installed.</span></span>
   <span data-ttu-id="9f9ce-115">次に、ローカルの HelpInfo XML ファイルをモジュールディレクトリに保存し、更新を終了します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-115">Then it saves the local HelpInfo XML file in the module directory and concludes the update.</span></span>

## <a name="the-save-help-process"></a><span data-ttu-id="9f9ce-116">保存時のヘルプ</span><span class="sxs-lookup"><span data-stu-id="9f9ce-116">The Save-Help Process</span></span>

<span data-ttu-id="9f9ce-117">次の一覧では、ユーザーがファイル共有内のヘルプファイルを更新するコマンドを実行し、そのファイルを使用してユーザーのコンピューター上のヘルプファイルを更新するときの、 [help](/powershell/module/Microsoft.PowerShell.Core/Save-Help)および[update-help](/powershell/module/Microsoft.PowerShell.Core/Update-Help)コマンドレットの動作について説明します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-117">The following list describes the actions of the [Save-Help](/powershell/module/Microsoft.PowerShell.Core/Save-Help) and [Update-Help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) cmdlets when a user runs commands to update the help files in a file share, and then use those files to update the help files on the user's computer.</span></span>

<span data-ttu-id="9f9ce-118">`Save-Help`コマンドレットは、 **DestinationPath**パラメーターで指定されたファイル共有内のモジュールのヘルプファイルを保存するコマンドに応答して、次の操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-118">The `Save-Help` cmdlet performs the following actions in response to a command to save the help files for a module in a file share that is specified by the **DestinationPath** parameter.</span></span>

1. <span data-ttu-id="9f9ce-119">`Save-Help`モジュールマニフェストの**Helpinfouri**キーの値によって指定された場所からリモートの HelpInfo XML ファイルを取得し、スキーマに対してファイルを検証します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-119">`Save-Help` gets the remote HelpInfo XML file from the location specified by the value of the **HelpInfoURI** key in the module manifest and validates the file against the schema.</span></span> <span data-ttu-id="9f9ce-120">(スキーマを表示するには、「 [HELPINFO XML schema](./helpinfo-xml-schema.md)」を参照してください)。は、 `Save-Help` コマンドで**DestinationPath**パラメーターで指定されたディレクトリでローカル HelpInfo XML ファイルを検索し `Save-Help` ます。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-120">(To view the schema, see [HelpInfo XML Schema](./helpinfo-xml-schema.md).) Then `Save-Help` looks for a local HelpInfo XML file in the directory that is specified by the **DestinationPath** parameter in the `Save-Help` command.</span></span>

1. <span data-ttu-id="9f9ce-121">`Save-Help`モジュールのリモートおよびローカルの HelpInfo XML ファイル内にある、指定した UI カルチャのヘルプファイルのバージョン番号を比較します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-121">`Save-Help` compares the version number of the help files for the specified UI culture in the remote and local HelpInfo XML files for the module.</span></span> <span data-ttu-id="9f9ce-122">リモートファイルのバージョン番号がローカルファイルのバージョン番号よりも大きい場合、または**DestinationPath**ディレクトリにモジュール用のローカル HelpInfo XML ファイルがない場合は、によって `Save-Help` 新しいヘルプファイルのダウンロードが準備されます。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-122">If the version number on the remote file is greater than version number on the local file, or if the there is no local HelpInfo XML file for the module in the **DestinationPath** directory, `Save-Help` prepares to download new help files.</span></span>

1. <span data-ttu-id="9f9ce-123">`Save-Help`リモート HelpInfo XML ファイルの**Helpcontenturi**要素によって指定された場所からモジュールの CAB ファイルを選択します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-123">`Save-Help` selects the CAB file for the module from the location specified by the **HelpContentUri** element in the remote HelpInfo XML file.</span></span> <span data-ttu-id="9f9ce-124">モジュール名、モジュール GUID、および UI カルチャを使用して、CAB ファイルを識別します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-124">It uses the module name, module GUID, and UI culture to identify the CAB file.</span></span>

1. <span data-ttu-id="9f9ce-125">`Save-Help`CAB ファイルをダウンロードし、 **DestinationPath**ディレクトリに保存します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-125">`Save-Help` downloads the CAB file and saves it in the **DestinationPath** directory.</span></span> <span data-ttu-id="9f9ce-126">(言語固有のサブディレクトリは作成されません)。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-126">(It does not create any language-specific subdirectories.)</span></span>

1. <span data-ttu-id="9f9ce-127">`Save-Help`リモートの HelpInfo XML ファイルをコピーすることによって、ローカルの HelpInfo XML ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-127">`Save-Help` creates a local HelpInfo XML file by copying the remote HelpInfo XML file.</span></span> <span data-ttu-id="9f9ce-128">ローカルの HelpInfo XML ファイルを編集して、保存された CAB ファイルの要素のみが含まれるようにします。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-128">It edits the local HelpInfo XML file so that it includes elements only for the CAB file that it saved.</span></span>
   <span data-ttu-id="9f9ce-129">次に、ローカルの HelpInfo XML ファイルを**DestinationPath**ディレクトリに保存し、更新を終了します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-129">Then it saves the local HelpInfo XML file in the **DestinationPath** directory and concludes the update.</span></span>

   <span data-ttu-id="9f9ce-130">`Update-Help`コマンドレットは、 **SourcePath**パラメーターで指定されたファイル共有内のファイルからユーザーのコンピューター上のヘルプファイルを更新するコマンドに応答して、次の操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-130">The `Update-Help` cmdlet performs the following actions in response to a command to update the help files on a user's computer from the files in a file share that is specified by the **SourcePath** parameter.</span></span>

1. <span data-ttu-id="9f9ce-131">`Update-Help`**SourcePath**ディレクトリからリモートの HelpInfo XML ファイルを取得します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-131">`Update-Help` gets the remote HelpInfo XML file from the **SourcePath** directory.</span></span> <span data-ttu-id="9f9ce-132">次に、ユーザーのコンピューターのモジュールディレクトリでローカル HelpInfo XML ファイルを検索します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-132">Then it looks for a local HelpInfo XML file in the module directory on the user's computer.</span></span>

1. <span data-ttu-id="9f9ce-133">`Update-Help`モジュールのリモートおよびローカルの HelpInfo XML ファイル内にある、指定した UI カルチャのヘルプファイルのバージョン番号を比較します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-133">`Update-Help` compares the version number of the help files for the specified UI culture in the remote and local HelpInfo XML files for the module.</span></span> <span data-ttu-id="9f9ce-134">リモートファイルのバージョン番号がローカルファイルのバージョン番号よりも大きい場合、またはローカルの HelpInfo XML ファイルがない場合は、によって `Update-Help` 新しいヘルプファイルのインストールが準備されます。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-134">If the version number on the remote file is greater than version number on the local file, or if the there is no local HelpInfo XML file, `Update-Help` prepares to install new help files.</span></span>

1. <span data-ttu-id="9f9ce-135">`Update-Help`**SourcePath**ディレクトリからモジュールの CAB ファイルを選択します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-135">`Update-Help` selects the CAB file for the module from **SourcePath** directory.</span></span> <span data-ttu-id="9f9ce-136">モジュール名、モジュール GUID、および UI カルチャを使用して、CAB ファイルを識別します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-136">It uses the module name, module GUID, and UI culture to identify the CAB file.</span></span>

1. <span data-ttu-id="9f9ce-137">`Update-Help`CAB ファイルをアンパックし、ヘルプコンテンツファイルを検証して、ヘルプコンテンツファイルをユーザーのコンピューターのモジュールディレクトリの言語固有のサブディレクトリに保存します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-137">`Update-Help` unpacks the CAB file, validates the help content files, and saves the help content files in the language-specific subdirectory of the module directory on the user's computer.</span></span>

1. <span data-ttu-id="9f9ce-138">`Update-Help`リモートの HelpInfo XML ファイルをコピーすることによって、ローカルの HelpInfo XML ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-138">`Update-Help` creates a local HelpInfo XML file by copying the remote HelpInfo XML file.</span></span> <span data-ttu-id="9f9ce-139">ローカルの HelpInfo XML ファイルを編集して、インストールした CAB ファイルの要素のみが含まれるようにします。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-139">It edits the local HelpInfo XML file so that it includes elements only for the CAB file that it installed.</span></span>
   <span data-ttu-id="9f9ce-140">次に、ローカルの HelpInfo XML ファイルをモジュールディレクトリに保存し、更新を終了します。</span><span class="sxs-lookup"><span data-stu-id="9f9ce-140">Then it saves the local HelpInfo XML file in the module directory and concludes the update.</span></span>
