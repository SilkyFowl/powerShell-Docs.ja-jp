---
title: Windows PowerShell エラーレコード |Microsoft Docs
ms.date: 09/13/2016
helpviewer_keywords:
- error category [PowerShell SDK]
- error identifier [PowerShell SDK]
- error records [PowerShell SDK]
- error category string [PowerShell SDK]
ms.openlocfilehash: 52243916adf18b4f3a1e00f1fb4199c2619946e9
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/05/2020
ms.locfileid: "87783978"
---
# <a name="windows-powershell-error-records"></a><span data-ttu-id="874b9-102">Windows PowerShell エラー レコード</span><span class="sxs-lookup"><span data-stu-id="874b9-102">Windows PowerShell Error Records</span></span>

<span data-ttu-id="874b9-103">コマンドレットは、終了エラーと終了エラーのエラー状態を識別する、[システムの管理. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)オブジェクトを渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="874b9-103">Cmdlets must pass an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that identifies the error condition for terminating and non-terminating errors.</span></span>

<span data-ttu-id="874b9-104">この[オブジェクトには、](/dotnet/api/System.Management.Automation.ErrorRecord)次の情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="874b9-104">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object contains the following information:</span></span>

- <span data-ttu-id="874b9-105">エラーを説明する例外。</span><span class="sxs-lookup"><span data-stu-id="874b9-105">The exception that describes the error.</span></span> <span data-ttu-id="874b9-106">多くの場合、これは、コマンドレットがキャッチし、エラーレコードに変換した例外です。</span><span class="sxs-lookup"><span data-stu-id="874b9-106">Often, this is an exception that the cmdlet caught and converted into an error record.</span></span> <span data-ttu-id="874b9-107">すべてのエラーレコードに例外が含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="874b9-107">Every error record must contain an exception.</span></span>

<span data-ttu-id="874b9-108">コマンドレットが例外をキャッチしなかった場合は、新しい例外を作成し、エラー状態に最も適した例外クラスを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="874b9-108">If the cmdlet did not catch an exception, it must create a new exception and choose the exception class that best describes the error condition.</span></span> <span data-ttu-id="874b9-109">ただし、例外をスローする必要はありません。これは、この例外をスローする必要はありません。これは、[システム](/dotnet/api/System.Management.Automation.ErrorRecord)の管理. errorrecord オブジェクトの[system.object プロパティを](/dotnet/api/System.Management.Automation.ErrorRecord.Exception)介してアクセスできるためです。</span><span class="sxs-lookup"><span data-stu-id="874b9-109">However, you do not need to throw the exception because it can be accessed through the [System.Management.Automation.ErrorRecord.Exception](/dotnet/api/System.Management.Automation.ErrorRecord.Exception) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

- <span data-ttu-id="874b9-110">診断の目的で使用できるターゲット指定子と、特定のエラーハンドラーで特定のエラー条件を処理するための Windows PowerShell スクリプトによって提供される、エラー識別子。</span><span class="sxs-lookup"><span data-stu-id="874b9-110">An error identifier that provides a targeted designator that can be used for diagnostic purposes and by Windows PowerShell scripts to handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="874b9-111">すべてのエラーレコードには、エラー識別子を含める必要があります (「エラー識別子」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="874b9-111">Every error record must contain an error identifier (see Error Identifier).</span></span>

- <span data-ttu-id="874b9-112">診断目的で使用できる一般的な指定子を提供するエラーカテゴリ。</span><span class="sxs-lookup"><span data-stu-id="874b9-112">An error category that provides a general designator that can be used for diagnostic purposes.</span></span> <span data-ttu-id="874b9-113">すべてのエラーレコードでエラーカテゴリを指定する必要があります (「エラーカテゴリ」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="874b9-113">Every error record must specify an error category (see Error Category).</span></span>

- <span data-ttu-id="874b9-114">オプションの置換エラーメッセージと推奨される操作 (置換エラーメッセージを参照)。</span><span class="sxs-lookup"><span data-stu-id="874b9-114">An optional replacement error message and a recommended action (see Replacement Error Message).</span></span>

- <span data-ttu-id="874b9-115">エラーをスローしたコマンドレットに関するオプションの呼び出し情報。</span><span class="sxs-lookup"><span data-stu-id="874b9-115">Optional invocation information about the cmdlet that threw the error.</span></span> <span data-ttu-id="874b9-116">この情報は、Windows PowerShell によって指定されます (「呼び出しメッセージ」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="874b9-116">This information is specified by Windows PowerShell (see Invocation Message).</span></span>

- <span data-ttu-id="874b9-117">エラーが発生したときに処理されていたターゲットオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="874b9-117">The target object that was being processed when the error occurred.</span></span> <span data-ttu-id="874b9-118">これは入力オブジェクトである場合もあれば、コマンドレットが処理していた別のオブジェクトである場合もあります。</span><span class="sxs-lookup"><span data-stu-id="874b9-118">This might be the input object, or it might be another object that your cmdlet was processing.</span></span> <span data-ttu-id="874b9-119">たとえば、コマンドの場合、 `remove-item -recurse c:\somedirectory` エラーは "c:\somedirectory\lockedfile" の FileInfo オブジェクトのインスタンスである可能性があります。</span><span class="sxs-lookup"><span data-stu-id="874b9-119">For example, for the command `remove-item -recurse c:\somedirectory`, the error might be an instance of a FileInfo object for "c:\somedirectory\lockedfile".</span></span> <span data-ttu-id="874b9-120">ターゲットオブジェクトの情報は省略可能です。</span><span class="sxs-lookup"><span data-stu-id="874b9-120">The target object information is optional.</span></span>

## <a name="error-identifier"></a><span data-ttu-id="874b9-121">エラー識別子</span><span class="sxs-lookup"><span data-stu-id="874b9-121">Error Identifier</span></span>

<span data-ttu-id="874b9-122">エラーレコードを作成するときに、コマンドレット内でエラー条件を指定する識別子を指定します。</span><span class="sxs-lookup"><span data-stu-id="874b9-122">When you create an error record, specify an identifier that designates the error condition within your cmdlet.</span></span> <span data-ttu-id="874b9-123">Windows PowerShell では、対象となる識別子をコマンドレットの名前と組み合わせて、完全修飾エラー識別子を作成します。</span><span class="sxs-lookup"><span data-stu-id="874b9-123">Windows PowerShell combines the targeted identifier with the name of your cmdlet to create a fully qualified error identifier.</span></span> <span data-ttu-id="874b9-124">完全修飾されたエラー識別子にアクセスするに[は、FullyQualifiedErrorId オブジェクトの](/dotnet/api/System.Management.Automation.ErrorRecord) [System.Management.Automation.ErrorRecord.FullyQualifiedErrorId](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId)プロパティを使用する必要がありますので、</span><span class="sxs-lookup"><span data-stu-id="874b9-124">The fully qualified error identifier can be accessed through the [System.Management.Automation.ErrorRecord.FullyQualifiedErrorId](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="874b9-125">エラー識別子は、単独では使用できません。</span><span class="sxs-lookup"><span data-stu-id="874b9-125">The error identifier is not available by itself.</span></span> <span data-ttu-id="874b9-126">完全修飾エラー識別子の一部としてのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="874b9-126">It is available only as part of the fully qualified error identifier.</span></span>

<span data-ttu-id="874b9-127">エラーレコードを作成するときにエラー識別子を生成するには、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="874b9-127">Use the following guidelines to generate error identifiers when you create error records:</span></span>

- <span data-ttu-id="874b9-128">エラー条件に固有のエラー識別子を作成します。</span><span class="sxs-lookup"><span data-stu-id="874b9-128">Make error identifiers specific to an error condition.</span></span> <span data-ttu-id="874b9-129">診断目的のエラー識別子と、特定のエラーハンドラーを使用して特定のエラー条件を処理するスクリプトを対象とします。</span><span class="sxs-lookup"><span data-stu-id="874b9-129">Target the error identifiers for diagnostic purposes and for scripts that handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="874b9-130">ユーザーは、エラー識別子を使用してエラーとそのソースを識別できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="874b9-130">A user should be able to use the error identifier to identify the error and its source.</span></span> <span data-ttu-id="874b9-131">また、エラー識別子を使用すると、既存の例外からの特定のエラー条件をレポートして、新しい例外サブクラスが不要になるようにすることもできます。</span><span class="sxs-lookup"><span data-stu-id="874b9-131">Error identifiers also enable reporting for specific error conditions from existing exceptions so that new exception subclasses are not required.</span></span>

- <span data-ttu-id="874b9-132">一般に、異なるコードパスに別のエラー識別子を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="874b9-132">In general, assign different error identifiers to different code paths.</span></span> <span data-ttu-id="874b9-133">エンドユーザーは、特定の識別子を活用できます。</span><span class="sxs-lookup"><span data-stu-id="874b9-133">The end-user benefits from specific identifiers.</span></span> <span data-ttu-id="874b9-134">多くの場合、 [WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)または[Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)を呼び出す各コードパスには、独自の識別子があります。このような場合は、</span><span class="sxs-lookup"><span data-stu-id="874b9-134">Often, each code path that calls [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) has its own identifier.</span></span> <span data-ttu-id="874b9-135">規則として、エラーメッセージの新しいテンプレート文字列を定義するときに新しい識別子を定義します。その逆も同様です。</span><span class="sxs-lookup"><span data-stu-id="874b9-135">As a rule, define a new identifier when you define a new template string for the error message, and vice-versa.</span></span> <span data-ttu-id="874b9-136">エラーメッセージを識別子として使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="874b9-136">Do not use the error message as an identifier.</span></span>

- <span data-ttu-id="874b9-137">特定のエラー識別子を使用してコードを発行すると、完全な製品サポートライフサイクルのために、その識別子でのエラーのセマンティクスが確立されます。</span><span class="sxs-lookup"><span data-stu-id="874b9-137">When you publish code using a particular error identifier, you establish the semantics of errors with that identifier for your complete product support lifecycle.</span></span> <span data-ttu-id="874b9-138">元のコンテキストとは意味が異なるコンテキストでは再利用しないでください。</span><span class="sxs-lookup"><span data-stu-id="874b9-138">Do not reuse it in a context that is semantically different from the original context.</span></span> <span data-ttu-id="874b9-139">このエラーのセマンティクスが変更された場合は、新しい識別子を作成して使用します。</span><span class="sxs-lookup"><span data-stu-id="874b9-139">If the semantics of this error change, create and then use a new identifier.</span></span>

- <span data-ttu-id="874b9-140">通常は、特定の CLR 型の例外に対してのみ、特定のエラー識別子を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="874b9-140">You should generally use a particular error identifier only for exceptions of a particular CLR type.</span></span> <span data-ttu-id="874b9-141">例外の型またはターゲットオブジェクトの型が変更された場合は、新しい識別子を作成して使用します。</span><span class="sxs-lookup"><span data-stu-id="874b9-141">If the type of the exception or the type of the target object changes, create and then use a new identifier.</span></span>

- <span data-ttu-id="874b9-142">報告するエラーに簡潔に対応する、エラー id のテキストを選択します。</span><span class="sxs-lookup"><span data-stu-id="874b9-142">Choose text for your error identifier that concisely corresponds to the error that you are reporting.</span></span> <span data-ttu-id="874b9-143">標準の .NET Framework 名前付け規則と大文字小文字の表記規則を使用します。</span><span class="sxs-lookup"><span data-stu-id="874b9-143">Use standard .NET Framework naming and capitalization conventions.</span></span> <span data-ttu-id="874b9-144">空白や句読点は使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="874b9-144">Do not use white space or punctuation.</span></span> <span data-ttu-id="874b9-145">エラー識別子はローカライズしないでください。</span><span class="sxs-lookup"><span data-stu-id="874b9-145">Do not localize error identifiers.</span></span>

- <span data-ttu-id="874b9-146">エラー識別子は、再現不可能な方法で動的に生成しないようにしてください。</span><span class="sxs-lookup"><span data-stu-id="874b9-146">Do not dynamically generate error identifiers in a non-reproducible way.</span></span> <span data-ttu-id="874b9-147">たとえば、プロセス ID などのエラー情報を組み込むことはできません。</span><span class="sxs-lookup"><span data-stu-id="874b9-147">For example, do not incorporate error information such as a process ID.</span></span> <span data-ttu-id="874b9-148">エラー識別子は、同じエラー条件が発生している他のユーザーによって検出されたエラー識別子に対応している場合にのみ役立ちます。</span><span class="sxs-lookup"><span data-stu-id="874b9-148">Error identifiers are useful only if they correspond to the error identifiers seen by other users who are experiencing the same error condition.</span></span>

## <a name="error-category"></a><span data-ttu-id="874b9-149">エラー カテゴリ</span><span class="sxs-lookup"><span data-stu-id="874b9-149">Error Category</span></span>

<span data-ttu-id="874b9-150">エラーレコードを作成するときに、 [ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)列挙体で定義されている定数の1つを使用して、エラーのカテゴリを指定します。</span><span class="sxs-lookup"><span data-stu-id="874b9-150">When you create an error record, specify the category of the error using one of the constants defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) enumeration.</span></span> <span data-ttu-id="874b9-151">Windows PowerShell は、ユーザーが変数をに設定したときに、エラーカテゴリを使用してエラー情報を表示し `$ErrorView` `"CategoryView"` ます。</span><span class="sxs-lookup"><span data-stu-id="874b9-151">Windows PowerShell uses the error category to display error information when users set the `$ErrorView` variable to `"CategoryView"`.</span></span>

<span data-ttu-id="874b9-152">[ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) **notspecified**定数は使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="874b9-152">Avoid using the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) **NotSpecified** constant.</span></span> <span data-ttu-id="874b9-153">エラーまたはエラーの原因となった操作に関する情報がある場合は、カテゴリが完全に一致していない場合でも、エラーまたは操作について最もよく説明されているカテゴリを選択します。</span><span class="sxs-lookup"><span data-stu-id="874b9-153">If you have any information about the error or about the operation that caused the error, choose the category that best describes the error or the operation, even if the category is not a perfect match.</span></span>

<span data-ttu-id="874b9-154">Windows PowerShell によって表示される情報は、カテゴリビュー文字列として参照され、[システム](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)のプロパティから構築されます。</span><span class="sxs-lookup"><span data-stu-id="874b9-154">The information displayed by Windows PowerShell is referred to as the category-view string and is built from the properties of the [System.Management.Automation.Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo) class.</span></span> <span data-ttu-id="874b9-155">(このクラスには、エラーの "システムの管理... [ErrorRecord. カテゴリ情報](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo)" プロパティを使用してアクセスします)。</span><span class="sxs-lookup"><span data-stu-id="874b9-155">(This class is accessed through the error [System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo) property.)</span></span>

```
{Category}: ({TargetName}:{TargetType}):[{Activity}], {Reason}
```

<span data-ttu-id="874b9-156">次の一覧に、表示される情報を示します。</span><span class="sxs-lookup"><span data-stu-id="874b9-156">The following list describes the information displayed:</span></span>

- <span data-ttu-id="874b9-157">Category: Windows PowerShell で定義された[ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)定数。</span><span class="sxs-lookup"><span data-stu-id="874b9-157">Category: A Windows PowerShell-defined [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) constant.</span></span>

- <span data-ttu-id="874b9-158">TargetName: 既定では、エラーが発生したときにコマンドレットが処理していたオブジェクトの名前。</span><span class="sxs-lookup"><span data-stu-id="874b9-158">TargetName: By default, the name of the object the cmdlet was processing when the error occurred.</span></span> <span data-ttu-id="874b9-159">または、別のコマンドレットで定義された文字列。</span><span class="sxs-lookup"><span data-stu-id="874b9-159">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="874b9-160">TargetType: 既定では、ターゲットオブジェクトの型です。</span><span class="sxs-lookup"><span data-stu-id="874b9-160">TargetType: By default, the type of the target object.</span></span> <span data-ttu-id="874b9-161">または、別のコマンドレットで定義された文字列。</span><span class="sxs-lookup"><span data-stu-id="874b9-161">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="874b9-162">アクティビティ: 既定では、エラーレコードを作成したコマンドレットの名前。</span><span class="sxs-lookup"><span data-stu-id="874b9-162">Activity: By default, the name of the cmdlet that created the error record.</span></span> <span data-ttu-id="874b9-163">または、他のコマンドレットで定義された文字列。</span><span class="sxs-lookup"><span data-stu-id="874b9-163">Or, some other cmdlet-defined string.</span></span>

- <span data-ttu-id="874b9-164">理由: 既定では、例外の種類です。</span><span class="sxs-lookup"><span data-stu-id="874b9-164">Reason: By default, the exception type.</span></span> <span data-ttu-id="874b9-165">または、別のコマンドレットで定義された文字列。</span><span class="sxs-lookup"><span data-stu-id="874b9-165">Or, another cmdlet-defined string.</span></span>

## <a name="replacement-error-message"></a><span data-ttu-id="874b9-166">置換エラーメッセージ</span><span class="sxs-lookup"><span data-stu-id="874b9-166">Replacement Error Message</span></span>

<span data-ttu-id="874b9-167">コマンドレットのエラーレコードを作成する場合、エラーの既定のエラーメッセージは、 [system.exception](/dotnet/api/System.Exception.Message)プロパティの既定のメッセージテキストから取得されます。</span><span class="sxs-lookup"><span data-stu-id="874b9-167">When you develop an error record for a cmdlet, the default error message for the error comes from the default message text in the [System.Exception.Message](/dotnet/api/System.Exception.Message) property.</span></span> <span data-ttu-id="874b9-168">これは、(.NET Framework のガイドラインに従って) デバッグの目的でのみ使用されるメッセージテキストを含む読み取り専用のプロパティです。</span><span class="sxs-lookup"><span data-stu-id="874b9-168">This is a read-only property whose message text is intended only for debugging purposes (according to the .NET Framework guidelines).</span></span> <span data-ttu-id="874b9-169">既定のメッセージテキストを置換または補強するエラーメッセージを作成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="874b9-169">We recommend that you create an error message that replaces or augments the default message text.</span></span> <span data-ttu-id="874b9-170">メッセージをよりわかりやすく、コマンドレットにより具体的なものにします。</span><span class="sxs-lookup"><span data-stu-id="874b9-170">Make the message more user-friendly and more specific to the cmdlet.</span></span>

<span data-ttu-id="874b9-171">置換メッセージ[は、system.servicemodel オブジェクトに](/dotnet/api/System.Management.Automation.ErrorDetails)よって提供されます。</span><span class="sxs-lookup"><span data-stu-id="874b9-171">The replacement message is provided by an [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails) object.</span></span> <span data-ttu-id="874b9-172">Windows PowerShell で使用できる追加のローカライズ情報を提供するため、このオブジェクトの次のいずれかのコンストラクターを使用します。</span><span class="sxs-lookup"><span data-stu-id="874b9-172">Use one of the following constructors of this object because they provide additional localization information that can be used by Windows PowerShell.</span></span>

- <span data-ttu-id="874b9-173">[Errordetails (コマンドレット、文字列、文字列、オブジェクト [])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Management_Automation_Cmdlet_System_String_System_String_System_Object___): テンプレート文字列が、コマンドレットが実装されている同じアセンブリ内のリソース文字列であるか、またはテンプレート文字列をオーバーライドすることによってテンプレート文字列を読み込む場合[は、この](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)コンストラクターを使用します。</span><span class="sxs-lookup"><span data-stu-id="874b9-173">[ErrorDetails(Cmdlet, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Management_Automation_Cmdlet_System_String_System_String_System_Object___): Use this constructor if your template string is a resource string in the same assembly in which the cmdlet is implemented or if you want to load the template string through an override of the  [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString) method.</span></span>

- <span data-ttu-id="874b9-174">[Errordetails (Assembly、string、string、Object [])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Reflection_Assembly_System_String_System_String_System_Object___): このコンストラクターは、テンプレート文字列が別のアセンブリ内にあり、それをオーバーライドして読み込むことができない場合に使用し[ます。](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)</span><span class="sxs-lookup"><span data-stu-id="874b9-174">[ErrorDetails(Assembly, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Reflection_Assembly_System_String_System_String_System_Object___): Use this constructor if the template string is in another assembly and you do not load it through an override of [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString).</span></span>

<span data-ttu-id="874b9-175">この置換メッセージは、例外メッセージを作成するための .NET Framework 設計ガイドラインに従っている必要がありますが、わずかな違いがあります。</span><span class="sxs-lookup"><span data-stu-id="874b9-175">The replacement message should conform to the .NET Framework design guidelines for writing exception messages with a small difference.</span></span> <span data-ttu-id="874b9-176">例外メッセージが開発者向けに記述されていることを示すガイドラインの状態。</span><span class="sxs-lookup"><span data-stu-id="874b9-176">The guidelines state that exception messages should be written for developers.</span></span> <span data-ttu-id="874b9-177">これらの置換メッセージは、コマンドレットユーザー用に記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="874b9-177">These replacement messages should be written for the cmdlet user.</span></span>

<span data-ttu-id="874b9-178">置換エラーメッセージは、 [WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)または[Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)メソッドが呼び出される前に追加されている必要があります。このメッセージは、</span><span class="sxs-lookup"><span data-stu-id="874b9-178">The replacement error message must be added before the [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) methods are called.</span></span> <span data-ttu-id="874b9-179">置換メッセージを追加するには、エラーレコード[の "system.string](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails) " プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="874b9-179">To add a replacement message, set the [System.Management.Automation.ErrorRecord.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails) property of the error record.</span></span> <span data-ttu-id="874b9-180">このプロパティが設定されている場合、Windows PowerShell は、既定のメッセージテキストではなく、system.string [\*](/dotnet/api/System.Management.Automation.ErrorDetails.Message)プロパティを表示します。</span><span class="sxs-lookup"><span data-stu-id="874b9-180">When this property is set, Windows PowerShell displays the [System.Management.Automation.ErrorDetails.Message\*](/dotnet/api/System.Management.Automation.ErrorDetails.Message) property instead of the default message text.</span></span>

## <a name="recommended-action-information"></a><span data-ttu-id="874b9-181">推奨される操作情報</span><span class="sxs-lookup"><span data-stu-id="874b9-181">Recommended Action Information</span></span>

<span data-ttu-id="874b9-182">また[、エラー](/dotnet/api/System.Management.Automation.ErrorDetails)が発生したときに推奨される操作に関する情報を提供することもできます。</span><span class="sxs-lookup"><span data-stu-id="874b9-182">The [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails) object can also provide information about what actions are recommended when the error occurs.</span></span>

## <a name="invocation-information"></a><span data-ttu-id="874b9-183">呼び出し情報</span><span class="sxs-lookup"><span data-stu-id="874b9-183">Invocation information</span></span>

<span data-ttu-id="874b9-184">コマンドレットが[WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)または[Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)を使用してエラーレコードを報告すると、Windows PowerShell によって、エラーが発生したときに呼び出されたコマンドを説明する情報が自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="874b9-184">When a cmdlet uses [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) to report an error record, Windows PowerShell automatically adds information that describes the command that was invoked when the error occurred.</span></span> <span data-ttu-id="874b9-185">この情報は、 [Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo)オブジェクトによって提供されます。このオブジェクトには、コマンドによって呼び出されたコマンドレットの名前、コマンド自体、およびパイプラインまたはスクリプトに関する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="874b9-185">This information is provided by a [System.Management.Automation.Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo) object that contains the name of the cmdlet that was invoked by the command, the command itself, and information about the pipeline or script.</span></span> <span data-ttu-id="874b9-186">このプロパティは読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="874b9-186">This property is read-only.</span></span>

## <a name="see-also"></a><span data-ttu-id="874b9-187">参照</span><span class="sxs-lookup"><span data-stu-id="874b9-187">See Also</span></span>

[<span data-ttu-id="874b9-188">WriteError (システム管理)</span><span class="sxs-lookup"><span data-stu-id="874b9-188">System.Management.Automation.Cmdlet.WriteError</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)

[<span data-ttu-id="874b9-189">Throwterminatingerror \* のようになります。</span><span class="sxs-lookup"><span data-stu-id="874b9-189">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)

[<span data-ttu-id="874b9-190">ErrorCategory (システム管理)</span><span class="sxs-lookup"><span data-stu-id="874b9-190">System.Management.Automation.ErrorCategory</span></span>](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)

[<span data-ttu-id="874b9-191">システムの管理. Errorカテゴリの情報</span><span class="sxs-lookup"><span data-stu-id="874b9-191">System.Management.Automation.Errorcategoryinfo</span></span>](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)

[<span data-ttu-id="874b9-192">システムの管理. ErrorRecord</span><span class="sxs-lookup"><span data-stu-id="874b9-192">System.Management.Automation.ErrorRecord</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord)

[<span data-ttu-id="874b9-193">システムの管理. ErrorDetails</span><span class="sxs-lookup"><span data-stu-id="874b9-193">System.Management.Automation.ErrorDetails</span></span>](/dotnet/api/System.Management.Automation.ErrorDetails)

[<span data-ttu-id="874b9-194">Invocationinfo (システム管理)</span><span class="sxs-lookup"><span data-stu-id="874b9-194">System.Management.Automation.Invocationinfo</span></span>](/dotnet/api/System.Management.Automation.InvocationInfo)

[<span data-ttu-id="874b9-195">Windows PowerShell エラー レポート</span><span class="sxs-lookup"><span data-stu-id="874b9-195">Windows PowerShell Error Reporting</span></span>](./error-reporting-concepts.md)

[<span data-ttu-id="874b9-196">Writing a Windows PowerShell Cmdlet (Windows PowerShell コマンドレットの記述)</span><span class="sxs-lookup"><span data-stu-id="874b9-196">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
