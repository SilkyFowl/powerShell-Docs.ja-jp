---
title: コマンドレットの概要
ms.date: 06/11/2020
ms.openlocfilehash: 576df03f35dff80479d1fce18cf4306c9219d42f
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/05/2020
ms.locfileid: "87784403"
---
# <a name="cmdlet-overview"></a><span data-ttu-id="e27a8-102">コマンドレットの概要</span><span class="sxs-lookup"><span data-stu-id="e27a8-102">Cmdlet Overview</span></span>

<span data-ttu-id="e27a8-103">コマンドレットは、PowerShell 環境で使用される簡易コマンドです。</span><span class="sxs-lookup"><span data-stu-id="e27a8-103">A cmdlet is a lightweight command that is used in the PowerShell environment.</span></span> <span data-ttu-id="e27a8-104">PowerShell ランタイムは、コマンドラインで指定されたオートメーションスクリプトのコンテキスト内でこれらのコマンドレットを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-104">The PowerShell runtime invokes these cmdlets within the context of automation scripts that are provided at the command line.</span></span> <span data-ttu-id="e27a8-105">Powershell ランタイムでは、PowerShell Api を使用してプログラムで呼び出すこともできます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-105">The PowerShell runtime also invokes them programmatically through PowerShell APIs.</span></span>

## <a name="cmdlets"></a><span data-ttu-id="e27a8-106">コマンドレット</span><span class="sxs-lookup"><span data-stu-id="e27a8-106">Cmdlets</span></span>

<span data-ttu-id="e27a8-107">コマンドレットは、アクションを実行し、通常、パイプラインの次のコマンドに Microsoft .NET オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-107">Cmdlets perform an action and typically return a Microsoft .NET object to the next command in the pipeline.</span></span> <span data-ttu-id="e27a8-108">コマンドレットは、PowerShell のパイプラインセマンティクスに関与する単一のコマンドです。</span><span class="sxs-lookup"><span data-stu-id="e27a8-108">A cmdlet is a single command that participates in the pipeline semantics of PowerShell.</span></span>
<span data-ttu-id="e27a8-109">これには、バイナリ (C#) コマンドレット、高度なスクリプト関数、CDXML、ワークフローが含まれます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-109">This includes binary (C#) cmdlets, advanced script functions, CDXML, and Workflows.</span></span>

<span data-ttu-id="e27a8-110">この SDK ドキュメントでは、C# で記述されたバイナリコマンドレットを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-110">This SDK documentation describes how to create binary cmdlets written in C#.</span></span> <span data-ttu-id="e27a8-111">スクリプトベースのコマンドレットの詳細については、以下を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-111">For information about script-based cmdlets, see:</span></span>

- [<span data-ttu-id="e27a8-112">about_Functions_Advanced</span><span class="sxs-lookup"><span data-stu-id="e27a8-112">about_Functions_Advanced</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_advanced)
- [<span data-ttu-id="e27a8-113">about_Functions_CmdletBindingAttribute</span><span class="sxs-lookup"><span data-stu-id="e27a8-113">about_Functions_CmdletBindingAttribute</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_cmdletbindingattribute)
- [<span data-ttu-id="e27a8-114">about_Functions_Advanced_Methods</span><span class="sxs-lookup"><span data-stu-id="e27a8-114">about_Functions_Advanced_Methods</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_advanced_methods)

<span data-ttu-id="e27a8-115">バイナリコマンドレットを作成するには、2つの特殊なコマンドレットの基底クラスから派生したコマンドレットクラスを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e27a8-115">To create a binary cmdlet, you must implement a cmdlet class that derives from one of two specialized cmdlet base classes.</span></span> <span data-ttu-id="e27a8-116">派生クラスには次のものが必要です。</span><span class="sxs-lookup"><span data-stu-id="e27a8-116">The derived class must:</span></span>

- <span data-ttu-id="e27a8-117">派生クラスをコマンドレットとして識別する属性を宣言します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-117">Declare an attribute that identifies the derived class as a cmdlet.</span></span>
- <span data-ttu-id="e27a8-118">コマンドレットのパラメーターとしてパブリックプロパティを識別する属性で装飾されたパブリックプロパティを定義します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-118">Define public properties that are decorated with attributes that identify the public properties as cmdlet parameters.</span></span>
- <span data-ttu-id="e27a8-119">1つ以上の入力処理メソッドをオーバーライドしてレコードを処理します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-119">Override one or more of the input processing methods to process records.</span></span>

<span data-ttu-id="e27a8-120">クラスを含むアセンブリ[は、tialsessionstate コマンドレット](/powershell/module/microsoft.powershell.core/import-module)を使用して直接読み込むことも、または、 [System.Management.Automation.Runspaces.Ini](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API を使用してアセンブリを読み込むホストアプリケーションを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-120">You can load the assembly that contains the class directly by using the [Import-Module](/powershell/module/microsoft.powershell.core/import-module) cmdlet, or you can create a host application that loads the assembly by using the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span></span> <span data-ttu-id="e27a8-121">どちらの方法でも、プログラムおよびコマンドラインからコマンドレットの機能にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-121">Both methods provide programmatic and command-line access to the functionality of the cmdlet.</span></span>

## <a name="cmdlet-terms"></a><span data-ttu-id="e27a8-122">コマンドレットの使用条件</span><span class="sxs-lookup"><span data-stu-id="e27a8-122">Cmdlet Terms</span></span>

<span data-ttu-id="e27a8-123">PowerShell コマンドレットのドキュメントでは、次の用語が頻繁に使用されます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-123">The following terms are used frequently in the PowerShell cmdlet documentation:</span></span>

### <a name="cmdlet-attribute"></a><span data-ttu-id="e27a8-124">コマンドレット属性</span><span class="sxs-lookup"><span data-stu-id="e27a8-124">Cmdlet attribute</span></span>

<span data-ttu-id="e27a8-125">コマンドレットクラスをコマンドレットとして宣言するために使用される .NET 属性。</span><span class="sxs-lookup"><span data-stu-id="e27a8-125">A .NET attribute that is used to declare a cmdlet class as a cmdlet.</span></span> <span data-ttu-id="e27a8-126">PowerShell では、省略可能な他のいくつかの属性が使用されますが、コマンドレットの属性は必須です。</span><span class="sxs-lookup"><span data-stu-id="e27a8-126">Although PowerShell uses several other attributes that are optional, the Cmdlet attribute is required.</span></span> <span data-ttu-id="e27a8-127">この属性の詳細については、「[コマンドレット属性の宣言](cmdlet-attribute-declaration.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-127">For more information about this attribute, see [Cmdlet Attribute Declaration](cmdlet-attribute-declaration.md).</span></span>

### <a name="cmdlet-parameter"></a><span data-ttu-id="e27a8-128">コマンドレット パラメーター</span><span class="sxs-lookup"><span data-stu-id="e27a8-128">Cmdlet parameter</span></span>

<span data-ttu-id="e27a8-129">ユーザーが使用できるパラメーター、またはコマンドレットを実行しているアプリケーションに対して使用可能なパラメーターを定義するパブリックプロパティ。</span><span class="sxs-lookup"><span data-stu-id="e27a8-129">The public properties that define the parameters that are available to the user or to the application that is running the cmdlet.</span></span> <span data-ttu-id="e27a8-130">コマンドレットには、必須の、名前付き、位置指定、および*スイッチ*のパラメーターを指定できます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-130">Cmdlets can have required, named, positional, and *switch* parameters.</span></span> <span data-ttu-id="e27a8-131">スイッチパラメーターを使用すると、呼び出しでパラメーターが指定されている場合にのみ評価されるパラメーターを定義できます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-131">Switch parameters allow you to define parameters that are evaluated only if the parameters are specified in the call.</span></span> <span data-ttu-id="e27a8-132">さまざまな種類のパラメーターの詳細については、「[コマンドレットパラメーター](cmdlet-parameters.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-132">For more information about the different types of parameters, see [Cmdlet Parameters](cmdlet-parameters.md).</span></span>

### <a name="parameter-set"></a><span data-ttu-id="e27a8-133">パラメーター セット</span><span class="sxs-lookup"><span data-stu-id="e27a8-133">Parameter set</span></span>

<span data-ttu-id="e27a8-134">特定のアクションを実行するために同じコマンドで使用できるパラメーターのグループ。</span><span class="sxs-lookup"><span data-stu-id="e27a8-134">A group of parameters that can be used in the same command to perform a specific action.</span></span> <span data-ttu-id="e27a8-135">コマンドレットには複数のパラメーターセットを含めることができますが、各パラメーターセットには一意のパラメーターが少なくとも1つ必要です。</span><span class="sxs-lookup"><span data-stu-id="e27a8-135">A cmdlet can have multiple parameter sets, but each parameter set must have at least one parameter that is unique.</span></span> <span data-ttu-id="e27a8-136">適切なコマンドレットの設計では、unique パラメーターも必須パラメーターであることを強く示唆しています。</span><span class="sxs-lookup"><span data-stu-id="e27a8-136">Good cmdlet design strongly suggests that the unique parameter also be a required parameter.</span></span>
<span data-ttu-id="e27a8-137">パラメーターセットの詳細については、「[コマンドレットパラメーターセット](cmdlet-parameter-sets.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-137">For more information about parameter sets, see [Cmdlet Parameter Sets](cmdlet-parameter-sets.md).</span></span>

### <a name="dynamic-parameter"></a><span data-ttu-id="e27a8-138">[動的パラメーター]</span><span class="sxs-lookup"><span data-stu-id="e27a8-138">Dynamic parameter</span></span>

<span data-ttu-id="e27a8-139">実行時にコマンドレットに追加されるパラメーター。</span><span class="sxs-lookup"><span data-stu-id="e27a8-139">A parameter that is added to the cmdlet at runtime.</span></span> <span data-ttu-id="e27a8-140">通常、動的パラメーターは、別のパラメーターが特定の値に設定されている場合に、コマンドレットに追加されます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-140">Typically, the dynamic parameters are added to the cmdlet when another parameter is set to a specific value.</span></span> <span data-ttu-id="e27a8-141">動的パラメーターの詳細については、「[コマンドレット動的パラメーター](cmdlet-dynamic-parameters.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-141">For more information about dynamic parameters, see [Cmdlet Dynamic Parameters](cmdlet-dynamic-parameters.md).</span></span>

### <a name="input-processing-methods"></a><span data-ttu-id="e27a8-142">入力処理メソッド</span><span class="sxs-lookup"><span data-stu-id="e27a8-142">Input processing methods</span></span>

<span data-ttu-id="e27a8-143">System.string[クラスは](/dotnet/api/System.Management.Automation.Cmdlet)、レコードを処理するために使用される次の仮想メソッドを提供します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-143">The [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class provides the following virtual methods that are used to process records.</span></span> <span data-ttu-id="e27a8-144">派生したすべてのコマンドレットクラスは、最初の3つのメソッドをオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e27a8-144">All the derived cmdlet classes must override one or more of the first three methods:</span></span>

- <span data-ttu-id="e27a8-145">[System.servicemodel []: コマンド](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)レットに対して、オプションの1回限りの前処理機能を提供するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-145">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Used to provide optional one-time, pre-processing functionality for the cmdlet.</span></span>
- <span data-ttu-id="e27a8-146">System.string: コマンドレットのレコードごとの処理機能を提供するために使用され[ます。](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)</span><span class="sxs-lookup"><span data-stu-id="e27a8-146">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Used to provide record-by-record processing functionality for the cmdlet.</span></span> <span data-ttu-id="e27a8-147">コマンドレットの入力によっては、すべての回数 (またはまったくではない) の呼び出しが必要になる場合があり[ます。](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)</span><span class="sxs-lookup"><span data-stu-id="e27a8-147">The [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method might be called any number of times, or not at all, depending on the input of the cmdlet.</span></span>
- <span data-ttu-id="e27a8-148">System.servicemodel: コマンドレットに対して、省略可能な1回限りの後処理機能を提供するために使用され[ます。](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)</span><span class="sxs-lookup"><span data-stu-id="e27a8-148">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Used to provide optional one-time, post-processing functionality for the cmdlet.</span></span>
- <span data-ttu-id="e27a8-149">[システムの管理]-[ [StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing)]: ユーザーがコマンドレットを非同期に停止したときに処理を停止するために使用されます (たとえば、 <kbd>CTRL</kbd>C キーを押すなど + <kbd>C</kbd>)。</span><span class="sxs-lookup"><span data-stu-id="e27a8-149">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Used to stop processing when the user stops the cmdlet asynchronously (for example, by pressing <kbd>CTRL</kbd>+<kbd>C</kbd>).</span></span>

<span data-ttu-id="e27a8-150">これらのメソッドの詳細については、「[コマンドレットの入力処理方法](./cmdlet-input-processing-methods.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-150">For more information about these methods, see [Cmdlet Input Processing Methods](./cmdlet-input-processing-methods.md).</span></span>

<span data-ttu-id="e27a8-151">コマンドレットを実装する場合は、これらの入力処理メソッドの少なくとも1つをオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e27a8-151">When you implement a cmdlet, you must override at least one of these input processing methods.</span></span>
<span data-ttu-id="e27a8-152">通常、 **Processrecord ()** は、コマンドレットが処理するすべてのレコードに対して呼び出されるため、オーバーライドするメソッドです。</span><span class="sxs-lookup"><span data-stu-id="e27a8-152">Typically, the **ProcessRecord()** is the method that you override because it is called for every record that the cmdlet processes.</span></span> <span data-ttu-id="e27a8-153">これに対して、 **beginprocessing ()** メソッドと**EndProcessing ()** メソッドは、レコードの前処理または後処理を実行するために1回呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-153">In contrast, the **BeginProcessing()** method and the **EndProcessing()** method are called one time to perform pre-processing or post-processing of the records.</span></span> <span data-ttu-id="e27a8-154">これらのメソッドの詳細については、「[入力処理方法](cmdlet-input-processing-methods.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-154">For more information about these methods, see [Input Processing Methods](cmdlet-input-processing-methods.md).</span></span>

### <a name="shouldprocess-feature"></a><span data-ttu-id="e27a8-155">機能を処理する</span><span class="sxs-lookup"><span data-stu-id="e27a8-155">ShouldProcess feature</span></span>

<span data-ttu-id="e27a8-156">PowerShell では、コマンドレットがシステムに変更を加える前に、ユーザーにフィードバックを求めるコマンドレットを作成できます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-156">PowerShell allows you to create cmdlets that prompt the user for feedback before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="e27a8-157">この機能を使用するには、コマンドレットの属性を宣言するときに、この機能がサポートされていることをコマンドレットが宣言する必要があります。また、コマンドレットは、 `ShouldProcess` 入力処理メソッド内からメソッド[を](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)呼び出す必要があり[ます。](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)</span><span class="sxs-lookup"><span data-stu-id="e27a8-157">To use this feature, the cmdlet must declare that it supports the `ShouldProcess` feature when you declare the Cmdlet attribute, and the cmdlet must call the [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) and [System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) methods from within an input processing method.</span></span> <span data-ttu-id="e27a8-158">機能をサポートする方法の詳細については `ShouldProcess` 、「[確認の要求](requesting-confirmation-from-cmdlets.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-158">For more information about how to support the `ShouldProcess` functionality, see [Requesting Confirmation](requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="transaction"></a><span data-ttu-id="e27a8-159">トランザクション</span><span class="sxs-lookup"><span data-stu-id="e27a8-159">Transaction</span></span>

<span data-ttu-id="e27a8-160">1つのタスクとして扱われるコマンドの論理グループ。</span><span class="sxs-lookup"><span data-stu-id="e27a8-160">A logical group of commands that are treated as a single task.</span></span> <span data-ttu-id="e27a8-161">グループ内のいずれかのコマンドが失敗し、ユーザーがトランザクション内で実行されたアクションを受け入れるか拒否するかを選択できる場合、タスクは自動的に失敗します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-161">The task automatically fails if any command in the group fails, and the user has the choice to accept or reject the actions performed within the transaction.</span></span> <span data-ttu-id="e27a8-162">コマンドレットは、トランザクションに参加するには、コマンドレットの属性が宣言されているときにトランザクションをサポートするように宣言する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e27a8-162">To participate in a transaction, the cmdlet must declare that it supports transactions when the Cmdlet attribute is declared.</span></span> <span data-ttu-id="e27a8-163">トランザクションのサポートは、Windows PowerShell 2.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="e27a8-163">Support for transactions was introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="e27a8-164">トランザクションの詳細については、「[トランザクションをサポートする方法](how-to-support-transactions.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-164">For more information about transactions, see [How to Support Transactions](how-to-support-transactions.md).</span></span>

## <a name="how-cmdlets-differ-from-commands"></a><span data-ttu-id="e27a8-165">コマンドレットの違い</span><span class="sxs-lookup"><span data-stu-id="e27a8-165">How Cmdlets Differ from Commands</span></span>

<span data-ttu-id="e27a8-166">コマンドレットは、次の方法で他のコマンドシェル環境のコマンドとは異なります。</span><span class="sxs-lookup"><span data-stu-id="e27a8-166">Cmdlets differ from commands in other command-shell environments in the following ways:</span></span>

- <span data-ttu-id="e27a8-167">コマンドレットは .NET クラスのインスタンスです。これらはスタンドアロンの実行可能ファイルではありません。</span><span class="sxs-lookup"><span data-stu-id="e27a8-167">Cmdlets are instances of .NET classes; they are not stand-alone executables.</span></span>
- <span data-ttu-id="e27a8-168">コマンドレットは、数十のコード行から作成できます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-168">Cmdlets can be created from as few as a dozen lines of code.</span></span>
- <span data-ttu-id="e27a8-169">コマンドレットは、通常、独自の解析、エラー表示、または出力書式設定を行いません。</span><span class="sxs-lookup"><span data-stu-id="e27a8-169">Cmdlets do not generally do their own parsing, error presentation, or output formatting.</span></span> <span data-ttu-id="e27a8-170">解析、エラー表示、および出力の書式設定は、PowerShell ランタイムによって処理されます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-170">Parsing, error presentation, and output formatting are handled by the PowerShell runtime.</span></span>
- <span data-ttu-id="e27a8-171">コマンドレットは、テキストのストリームからではなく、パイプラインからの入力オブジェクトを処理します。また、コマンドレットは通常、オブジェクトをパイプラインに出力として配信します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-171">Cmdlets process input objects from the pipeline rather than from streams of text, and cmdlets typically deliver objects as output to the pipeline.</span></span>
- <span data-ttu-id="e27a8-172">コマンドレットは、一度に1つのオブジェクトを処理するため、レコード指向です。</span><span class="sxs-lookup"><span data-stu-id="e27a8-172">Cmdlets are record-oriented because they process a single object at a time.</span></span>

## <a name="cmdlet-base-classes"></a><span data-ttu-id="e27a8-173">コマンドレットの基本クラス</span><span class="sxs-lookup"><span data-stu-id="e27a8-173">Cmdlet Base Classes</span></span>

<span data-ttu-id="e27a8-174">Windows PowerShell は、次の2つの基本クラスから派生したコマンドレットをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="e27a8-174">Windows PowerShell supports cmdlets that are derived from the following two base classes.</span></span>

- <span data-ttu-id="e27a8-175">ほとんどのコマンドレットは、 [system.servicemodel 基底クラス](/dotnet/api/System.Management.Automation.Cmdlet)から派生した .net クラスに基づいています。</span><span class="sxs-lookup"><span data-stu-id="e27a8-175">Most cmdlets are based on .NET classes that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) base class.</span></span>
  <span data-ttu-id="e27a8-176">このクラスから派生させることにより、コマンドレットは、Windows PowerShell ランタイムの最小限の依存関係を使用できます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-176">Deriving from this class allows a cmdlet to use the minimum set of dependencies on the Windows PowerShell runtime.</span></span> <span data-ttu-id="e27a8-177">これには 2 つ利点があります。</span><span class="sxs-lookup"><span data-stu-id="e27a8-177">This has two benefits.</span></span> <span data-ttu-id="e27a8-178">最初の利点は、コマンドレットオブジェクトが小さく、PowerShell ランタイムの変更によって影響を受ける可能性が低いことです。</span><span class="sxs-lookup"><span data-stu-id="e27a8-178">The first benefit is that the cmdlet objects are smaller, and you are less likely to be affected by changes to the PowerShell runtime.</span></span> <span data-ttu-id="e27a8-179">2つ目の利点は、必要に応じて、コマンドレットオブジェクトのインスタンスを直接作成し、PowerShell ランタイムを使用して呼び出すのではなく、直接呼び出すことができることです。</span><span class="sxs-lookup"><span data-stu-id="e27a8-179">The second benefit is that, if you have to, you can directly create an instance of the cmdlet object and then invoke it directly instead of invoking it through the PowerShell runtime.</span></span>

- <span data-ttu-id="e27a8-180">より複雑なコマンドレットは、 [PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)基底クラスから派生した .net クラスに基づいています。</span><span class="sxs-lookup"><span data-stu-id="e27a8-180">The more-complex cmdlets are based on .NET classes that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="e27a8-181">このクラスから派生させることにより、PowerShell ランタイムにはるかに多くのアクセス権を与えることができます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-181">Deriving from this class gives you much more access to the PowerShell runtime.</span></span> <span data-ttu-id="e27a8-182">このアクセスにより、コマンドレットは、スクリプトを呼び出したり、プロバイダーにアクセスしたり、現在のセッション状態にアクセスしたりすることができます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-182">This access allows your cmdlet to call scripts, to access providers, and to access the current session state.</span></span>
  <span data-ttu-id="e27a8-183">(現在のセッション状態にアクセスするには、セッション変数とユーザー設定を取得して設定します)。ただし、このクラスから派生すると、コマンドレットオブジェクトのサイズが大きくなり、コマンドレットが現在のバージョンの PowerShell ランタイムに密に結合されることになります。</span><span class="sxs-lookup"><span data-stu-id="e27a8-183">(To access the current session state, you get and set session variables and preferences.) However, deriving from this class increases the size of the cmdlet object, and it means that your cmdlet is more tightly coupled to the current version of the PowerShell runtime.</span></span>

<span data-ttu-id="e27a8-184">一般に、PowerShell ランタイムへの拡張アクセスが必要な場合を除き、[このクラスから](/dotnet/api/System.Management.Automation.Cmdlet)派生させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="e27a8-184">In general, unless you need the extended access to the PowerShell runtime, you should derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span>
<span data-ttu-id="e27a8-185">ただし、PowerShell ランタイムには、コマンドレットを実行するための広範なログ記録機能があります。</span><span class="sxs-lookup"><span data-stu-id="e27a8-185">However, the PowerShell runtime has extensive logging capabilities for the execution of cmdlets.</span></span> <span data-ttu-id="e27a8-186">監査モデルがこのログに依存している場合は、 [PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)クラスから派生することによって、別のコマンドレット内からコマンドレットを実行できないようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="e27a8-186">If your auditing model depends on this logging, you can prevent the execution of your cmdlet from within another cmdlet by deriving from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class.</span></span>

## <a name="cmdlet-attributes"></a><span data-ttu-id="e27a8-187">コマンドレットの属性</span><span class="sxs-lookup"><span data-stu-id="e27a8-187">Cmdlet Attributes</span></span>

<span data-ttu-id="e27a8-188">PowerShell では、コマンドレットの管理に使用されるいくつかの .NET 属性と、PowerShell によって提供され、コマンドレットで必要となる可能性がある共通の機能を指定します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-188">PowerShell defines several .NET attributes that are used to manage cmdlets and to specify common functionality that is provided by PowerShell and that might be required by the cmdlet.</span></span> <span data-ttu-id="e27a8-189">たとえば、属性を使用して、クラスをコマンドレットとして指定したり、コマンドレットのパラメーターを指定したり、コマンドレットの開発者がコマンドレットコードにその機能を実装する必要がないように入力の検証を要求したりします。</span><span class="sxs-lookup"><span data-stu-id="e27a8-189">For example, attributes are used to designate a class as a cmdlet, to specify the parameters of the cmdlet, and to request the validation of input so that cmdlet developers do not have to implement that functionality in their cmdlet code.</span></span> <span data-ttu-id="e27a8-190">属性の詳細については、「 [PowerShell attributes](./cmdlet-attributes.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-190">For more information about attributes, see [PowerShell Attributes](./cmdlet-attributes.md).</span></span>

## <a name="cmdlet-names"></a><span data-ttu-id="e27a8-191">コマンドレット名</span><span class="sxs-lookup"><span data-stu-id="e27a8-191">Cmdlet Names</span></span>

<span data-ttu-id="e27a8-192">PowerShell では、動詞と名詞の名前の組み合わせを使用して、コマンドレットに名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-192">PowerShell uses a verb-and-noun name pair to name cmdlets.</span></span> <span data-ttu-id="e27a8-193">たとえば、PowerShell に含まれているコマンドレットを使用して、 `Get-Command` コマンドシェルに登録されているすべてのコマンドレットを取得します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-193">For example, the `Get-Command` cmdlet included in PowerShell is used to get all the cmdlets that are registered in the command shell.</span></span> <span data-ttu-id="e27a8-194">動詞はコマンドレットが実行するアクションを識別し、名詞は、コマンドレットがアクションを実行するリソースを識別します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-194">The verb identifies the action that the cmdlet performs, and the noun identifies the resource on which the cmdlet performs its action.</span></span>

<span data-ttu-id="e27a8-195">これらの名前は、.NET クラスがコマンドレットとして宣言されている場合に指定します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-195">These names are specified when the .NET class is declared as a cmdlet.</span></span> <span data-ttu-id="e27a8-196">コマンドレットとして .NET クラスを宣言する方法の詳細については、「[コマンドレット属性の宣言](./cmdlet-class-declaration.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-196">For more information about how to declare a .NET class as a cmdlet, see [Cmdlet Attribute Declaration](./cmdlet-class-declaration.md).</span></span>

## <a name="writing-cmdlet-code"></a><span data-ttu-id="e27a8-197">コマンドレットコードの記述</span><span class="sxs-lookup"><span data-stu-id="e27a8-197">Writing Cmdlet Code</span></span>

<span data-ttu-id="e27a8-198">このドキュメントでは、コマンドレットコードの記述方法を確認する2つの方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="e27a8-198">This document provides two ways to discover how cmdlet code is written.</span></span> <span data-ttu-id="e27a8-199">コードをよく説明する必要がない場合は、[コマンドレットコードの例](./examples-of-cmdlet-code.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-199">If you prefer to see the code without much explanation, see [Examples of Cmdlet Code](./examples-of-cmdlet-code.md).</span></span> <span data-ttu-id="e27a8-200">コードの詳細については、「 [Getproc チュートリアル](./getproc-tutorial.md)」、「 [stopproc チュートリアル](./stopproc-tutorial.md)」、または「 [selectstr チュートリアル](./selectstr-tutorial.md)」のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-200">If you prefer more explanation about the code, see the [GetProc Tutorial](./getproc-tutorial.md), [StopProc Tutorial](./stopproc-tutorial.md), or [SelectStr Tutorial](./selectstr-tutorial.md) topics.</span></span>

<span data-ttu-id="e27a8-201">コマンドレットの記述に関するガイドラインの詳細については、「[コマンドレットの開発ガイドライン](./cmdlet-development-guidelines.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e27a8-201">For more information about the guidelines for writing cmdlets, see [Cmdlet Development Guidelines](./cmdlet-development-guidelines.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="e27a8-202">参照</span><span class="sxs-lookup"><span data-stu-id="e27a8-202">See Also</span></span>

[<span data-ttu-id="e27a8-203">PowerShell コマンドレットの概念</span><span class="sxs-lookup"><span data-stu-id="e27a8-203">PowerShell Cmdlet Concepts</span></span>](./windows-powershell-cmdlet-concepts.md)

[<span data-ttu-id="e27a8-204">PowerShell コマンドレットの記述</span><span class="sxs-lookup"><span data-stu-id="e27a8-204">Writing a PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

[<span data-ttu-id="e27a8-205">PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="e27a8-205">PowerShell SDK</span></span>](../windows-powershell-reference.md)
