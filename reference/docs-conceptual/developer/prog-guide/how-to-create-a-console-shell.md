---
title: コンソールシェルを作成する方法 |Microsoft Docs
ms.date: 09/13/2016
helpviewer_keywords:
- Make-Shell [PowerShell Programmer's Guide]
ms.openlocfilehash: 5d8231363ab804bfd7113ef69f0bdede445149a2
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/05/2020
ms.locfileid: "87771619"
---
# <a name="how-to-create-a-console-shell"></a><span data-ttu-id="bc3be-102">コンソール シェルを作成する方法</span><span class="sxs-lookup"><span data-stu-id="bc3be-102">How to Create a Console Shell</span></span>

<span data-ttu-id="bc3be-103">Windows PowerShell には、拡張不可能なコンソールシェルを作成するために使用される、"make kit" とも呼ばれるシェルの作成ツールが用意されています。</span><span class="sxs-lookup"><span data-stu-id="bc3be-103">Windows PowerShell provides a Make-Shell tool, also referred to as the "make-kit", that is used to create a console shell that is not extensible.</span></span> <span data-ttu-id="bc3be-104">この新しいツールで作成したシェルは、後で Windows PowerShell スナップインを使用して拡張することはできません。</span><span class="sxs-lookup"><span data-stu-id="bc3be-104">Shells created with this new tool cannot be extended later through a Windows PowerShell snap-in.</span></span>

## <a name="syntax"></a><span data-ttu-id="bc3be-105">構文</span><span class="sxs-lookup"><span data-stu-id="bc3be-105">Syntax</span></span>

<span data-ttu-id="bc3be-106">Make ファイル内からシェルを実行するために使用される構文を次に示します。</span><span class="sxs-lookup"><span data-stu-id="bc3be-106">Here is the syntax used to run Make-Shell from within a make-file.</span></span>

```
make-shell
  -out n.exe
  -namespace ns
  [ -lib libdirectory1[,libdirectory2,..] ]
  [ -reference ca1.dll[,ca2.dll,...] ]
  [ -formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...] ]
  [ -typedata td1.type.ps1xml[,td2.type.ps1xml,...] ]
  [ -source c1.cs [,c2.cs,...] ]
  [ -authorizationmanager authorizationManagerType ]
  [ -win32icon i.ico ]
  [ -initscript p.ps1 ]
  [ -builtinscript s1.ps1[,s2.ps1,...] ]
  [ -resource resourcefile.txt ]
  [ -cscflags cscFlags ]
  [ -? | -help ]
```

## <a name="parameters"></a><span data-ttu-id="bc3be-107">パラメーター</span><span class="sxs-lookup"><span data-stu-id="bc3be-107">Parameters</span></span>

<span data-ttu-id="bc3be-108">次に、Make シェルのパラメーターの簡単な説明を示します。</span><span class="sxs-lookup"><span data-stu-id="bc3be-108">Here is a brief description of the parameters of Make-Shell.</span></span>

> [!CAUTION]
> <span data-ttu-id="bc3be-109">アセンブリへの UNC パスは、シェルではサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="bc3be-109">UNC paths to assemblies are not supported by Make-Shell.</span></span>

|<span data-ttu-id="bc3be-110">パラメーター</span><span class="sxs-lookup"><span data-stu-id="bc3be-110">Parameter</span></span>|<span data-ttu-id="bc3be-111">説明</span><span class="sxs-lookup"><span data-stu-id="bc3be-111">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="bc3be-112">-out n.exe</span><span class="sxs-lookup"><span data-stu-id="bc3be-112">-out n.exe</span></span>|<span data-ttu-id="bc3be-113">必須。</span><span class="sxs-lookup"><span data-stu-id="bc3be-113">Required.</span></span> <span data-ttu-id="bc3be-114">生成するシェルの名前。</span><span class="sxs-lookup"><span data-stu-id="bc3be-114">The name of the shell to produce.</span></span> <span data-ttu-id="bc3be-115">パスは、このパラメーターの一部として指定されます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-115">The path is specified as part of this parameter.</span></span><br /><br /> <span data-ttu-id="bc3be-116">この値が指定されていない場合、シェルによって ".exe" がこの値に追加されます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-116">Make-shell will append ".exe" to this value if it is not specified.</span></span> <span data-ttu-id="bc3be-117">**注意:** 参照されている .dll ファイルと同じ名前の出力ファイルを作成しないでください。</span><span class="sxs-lookup"><span data-stu-id="bc3be-117">**Caution:**  Do not create an output file with the same name as the referenced .dll file.</span></span> <span data-ttu-id="bc3be-118">これを行おうとすると、シェルの作成ツールは同じ名前の .cs ファイルを作成します。これにより、コマンドレットのソースコードを含む .cs ファイルが上書きされます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-118">If you attempt this, the Make-Shell tool creates a .cs file with the same name, which will overwrite the .cs file that has your cmdlet source code.</span></span>|
|<span data-ttu-id="bc3be-119">-名前空間 ns</span><span class="sxs-lookup"><span data-stu-id="bc3be-119">-namespace ns</span></span>|<span data-ttu-id="bc3be-120">必須。</span><span class="sxs-lookup"><span data-stu-id="bc3be-120">Required.</span></span> <span data-ttu-id="bc3be-121">Runspaceconfiguration クラスに対して使用する名前空間[。](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration)これにより、キットが生成およびコンパイルされます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-121">The namespace to use for the derived [System.Management.Automation.Runspaces.Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration) class that the make-kit generates and compiles.</span></span>|
|<span data-ttu-id="bc3be-122">-lib libdirectory1 [, libdirectory2,..]</span><span class="sxs-lookup"><span data-stu-id="bc3be-122">-lib libdirectory1[,libdirectory2,..]</span></span>|<span data-ttu-id="bc3be-123">Windows PowerShell アセンブリ、パラメーターによって指定されたアセンブリ、 `reference` 別のアセンブリによって間接的に参照されるアセンブリ、.net システムアセンブリなど、.net アセンブリを検索するディレクトリ。</span><span class="sxs-lookup"><span data-stu-id="bc3be-123">The directories that are searched for .NET assemblies, including the Windows PowerShell assemblies, assemblies specified by the `reference` parameter, assemblies indirectly referenced by another assembly, and the .NET system assemblies.</span></span>|
|<span data-ttu-id="bc3be-124">-参照 ca1.dll [、ca2.dll,...]</span><span class="sxs-lookup"><span data-stu-id="bc3be-124">-reference ca1.dll[,ca2.dll,...]</span></span>|<span data-ttu-id="bc3be-125">シェルに含めるアセンブリのコンマ区切りのリスト。</span><span class="sxs-lookup"><span data-stu-id="bc3be-125">A comma-separated list of the assemblies to include in the shell.</span></span> <span data-ttu-id="bc3be-126">これらのアセンブリには、すべてのコマンドレットとプロバイダーアセンブリに加えて、読み込む必要のあるリソースアセンブリも含まれています。</span><span class="sxs-lookup"><span data-stu-id="bc3be-126">These assemblies  includes all cmdlet and provider assemblies, as well as resource assemblies that should be loaded.</span></span> <span data-ttu-id="bc3be-127">このパラメーターが指定されていない場合、Windows PowerShell によって提供されるコアコマンドレットとプロバイダーのみを含むシェルが生成されます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-127">If this parameter is not specified, then a shell is produced that contains only the core cmdlets and providers provided by Windows PowerShell.</span></span><br /><br /> <span data-ttu-id="bc3be-128">アセンブリは完全なパスを使用して指定できます。それ以外の場合は、パラメーターで指定されたパスを使用してアセンブリが検索され `lib` ます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-128">The assemblies can be specified using their full path, otherwise they will be searched for using the path specified by the `lib` parameter.</span></span>|
|<span data-ttu-id="bc3be-129">-formatdata fd1.format.ps1xml [, fd2.format.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="bc3be-129">-formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...]</span></span>|<span data-ttu-id="bc3be-130">シェルに含めるフォーマットデータのコンマ区切りのリスト。</span><span class="sxs-lookup"><span data-stu-id="bc3be-130">A comma-separated list of format data to include in the shell.</span></span> <span data-ttu-id="bc3be-131">このパラメーターが指定されていない場合、Windows PowerShell によって提供される形式データのみを含むシェルが生成されます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-131">If this parameter is not specified, then a shell is produced that contains only the format data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="bc3be-132">-typedata td1.type.ps1xml [、td2.type.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="bc3be-132">-typedata td1.type.ps1xml[,td2.type.ps1xml,...]</span></span>|<span data-ttu-id="bc3be-133">シェルに含める型データのコンマ区切りのリスト。</span><span class="sxs-lookup"><span data-stu-id="bc3be-133">A comma-separated list of type data to include in the shell.</span></span> <span data-ttu-id="bc3be-134">このパラメーターが指定されていない場合、Windows PowerShell によって提供される型データのみを含むシェルが生成されます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-134">If this parameter is not specified, then a shell is produced that contains only the type data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="bc3be-135">-source c1.cs [, c2.cs,...]</span><span class="sxs-lookup"><span data-stu-id="bc3be-135">-source c1.cs [,c2.cs,...]</span></span>|<span data-ttu-id="bc3be-136">シェル開発者によって提供される、シェルのビルドに必要なすべてのソースコードを含むファイルの名前。</span><span class="sxs-lookup"><span data-stu-id="bc3be-136">The name of a file, provided by the shell developer, that contains any source code needed to build the shell.</span></span><br /><br /> <span data-ttu-id="bc3be-137">ソースコードファイルには、次のいずれかのソースコードを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-137">The source code file can contain any of the following source code:</span></span><br /><br /> <span data-ttu-id="bc3be-138">-既定の承認マネージャーをオーバーライドする承認マネージャーの実装。</span><span class="sxs-lookup"><span data-stu-id="bc3be-138">-   The Authorization manager implementation that overrides the default authorization manager.</span></span> <span data-ttu-id="bc3be-139">(これは、アセンブリにコンパイルされることもあります)。</span><span class="sxs-lookup"><span data-stu-id="bc3be-139">(This could also be supplied compiled into an assembly.)</span></span><br /><span data-ttu-id="bc3be-140">-アセンブリ情報属性の宣言: Assemblycompanyattribute、Assemblycompanyattribute Attribute、AssemblyFileVersionAttribute、System.reflection.assemblyinformationalversionattribute>、Assemblycompanyattribute、および System.reflection.assemblytrademarkattribute>。</span><span class="sxs-lookup"><span data-stu-id="bc3be-140">-   Assembly informational attribute declarations: such as the AssemblyCompanyAttribute, AssemblyCopyrightAttribute, AssemblyFileVersionAttribute, AssemblyInformationalVersionAttribute, AssemblyProductAttribute, and AssemblyTrademarkAttribute.</span></span>|
|<span data-ttu-id="bc3be-141">-authorizationmanager authorizationManagerType</span><span class="sxs-lookup"><span data-stu-id="bc3be-141">-authorizationmanager authorizationManagerType</span></span>|<span data-ttu-id="bc3be-142">承認マネージャーの実装を含む型。</span><span class="sxs-lookup"><span data-stu-id="bc3be-142">The type that contains the authorization manager implementation.</span></span> <span data-ttu-id="bc3be-143">これは、ソースコードで定義することも、アセンブリにコンパイルすることもできます (パラメーターで指定 `reference` )。</span><span class="sxs-lookup"><span data-stu-id="bc3be-143">This can be defined in source code, or compiled into an assembly (specified by the `reference` parameter).</span></span> <span data-ttu-id="bc3be-144">このパラメーターが指定されていない場合は、既定のセキュリティマネージャーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-144">If this parameter is not specified, the default security manager is used.</span></span> <span data-ttu-id="bc3be-145">値は、名前空間を含む完全な型名にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bc3be-145">The value should be the full type name, including namespaces.</span></span>|
|<span data-ttu-id="bc3be-146">-win32icon i .ico</span><span class="sxs-lookup"><span data-stu-id="bc3be-146">-win32icon i.ico</span></span>|<span data-ttu-id="bc3be-147">シェルの .exe ファイルのアイコン。</span><span class="sxs-lookup"><span data-stu-id="bc3be-147">The icon for the .exe file for the shell.</span></span> <span data-ttu-id="bc3be-148">指定しない場合、シェルには、c# コンパイラに含まれるアイコン (存在する場合) が表示されます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-148">If not specified, then the shell will have the icon that the c# compiler includes (if any).</span></span>|
|<span data-ttu-id="bc3be-149">-initscript p.ps1</span><span class="sxs-lookup"><span data-stu-id="bc3be-149">-initscript p.ps1</span></span>|<span data-ttu-id="bc3be-150">シェルのスタートアッププロファイル。</span><span class="sxs-lookup"><span data-stu-id="bc3be-150">The startup profile for the shell.</span></span> <span data-ttu-id="bc3be-151">ファイルは "その他" として含まれています。シェルによる有効性チェックは行われません。</span><span class="sxs-lookup"><span data-stu-id="bc3be-151">The file is included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="bc3be-152">-builtinscript s1.ps1 [、s2.ps1,...]</span><span class="sxs-lookup"><span data-stu-id="bc3be-152">-builtinscript s1.ps1[,s2.ps1,...]</span></span>|<span data-ttu-id="bc3be-153">シェルの組み込みスクリプトの一覧。</span><span class="sxs-lookup"><span data-stu-id="bc3be-153">A list of built-in scripts for the shell.</span></span> <span data-ttu-id="bc3be-154">これらのスクリプトは、パスのスクリプトの前に検出され、シェルが構築されると、その内容を変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="bc3be-154">These scripts are discovered before scripts in the path, and their contents cannot be changed once the shell is built.</span></span><br /><br /> <span data-ttu-id="bc3be-155">ファイルは "その他" として含まれています。シェルによる有効性チェックは行われません。</span><span class="sxs-lookup"><span data-stu-id="bc3be-155">The files are included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="bc3be-156">-リソース resourcefile.txt</span><span class="sxs-lookup"><span data-stu-id="bc3be-156">-resource resourcefile.txt</span></span>|<span data-ttu-id="bc3be-157">シェルのヘルプおよびバナーリソースを含む .txt ファイル。</span><span class="sxs-lookup"><span data-stu-id="bc3be-157">The .txt file containing help and banner resources for the shell.</span></span> <span data-ttu-id="bc3be-158">最初のリソースの名前は ShellHelp で、パラメーターを指定してシェルが呼び出された場合に表示されるテキストが含まれてい `help` ます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-158">The first resource is named ShellHelp, and contains the text displayed if the shell is invoked with the `help` parameter.</span></span> <span data-ttu-id="bc3be-159">2番目のリソースは ShellBanner という名前で、シェルが対話モードで起動したときに表示されるテキストと著作権の情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="bc3be-159">The second resource is named ShellBanner, and it contains the text and copyright information displayed when the shell is launched in interactive mode.</span></span><br /><br /> <span data-ttu-id="bc3be-160">このパラメーターが指定されていない場合、またはこれらのリソースが存在しない場合は、一般的なヘルプとバナーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-160">If this parameter is not provided, or these resources are not present, then a generic help and banner are used.</span></span>|
|<span data-ttu-id="bc3be-161">-cscflags cscFlags</span><span class="sxs-lookup"><span data-stu-id="bc3be-161">-cscflags cscFlags</span></span>|<span data-ttu-id="bc3be-162">C# コンパイラに渡す必要があるフラグ (csc.exe)。</span><span class="sxs-lookup"><span data-stu-id="bc3be-162">Flags that should be passed to the C# compiler (csc.exe).</span></span> <span data-ttu-id="bc3be-163">これらは変更されずに渡されます。</span><span class="sxs-lookup"><span data-stu-id="bc3be-163">These are passed through unchanged.</span></span> <span data-ttu-id="bc3be-164">このパラメーターにスペースが含まれている場合は、二重引用符で囲む必要があります。</span><span class="sxs-lookup"><span data-stu-id="bc3be-164">If this parameter includes spaces, it should be surrounded in double-quotes.</span></span>|
|<span data-ttu-id="bc3be-165">-?</span><span class="sxs-lookup"><span data-stu-id="bc3be-165">-?</span></span><br /><br /> <span data-ttu-id="bc3be-166">-help</span><span class="sxs-lookup"><span data-stu-id="bc3be-166">-help</span></span>|<span data-ttu-id="bc3be-167">著作権メッセージとシェルのコマンドラインオプションを表示します。</span><span class="sxs-lookup"><span data-stu-id="bc3be-167">Displays the copyright message and Make-Shell command line options.</span></span>|
|<span data-ttu-id="bc3be-168">-verbose</span><span class="sxs-lookup"><span data-stu-id="bc3be-168">-verbose</span></span>|<span data-ttu-id="bc3be-169">シェルの作成中に詳細情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="bc3be-169">Displays detailed information while the shell is being created.</span></span>|

## <a name="see-also"></a><span data-ttu-id="bc3be-170">参照</span><span class="sxs-lookup"><span data-stu-id="bc3be-170">See Also</span></span>

[<span data-ttu-id="bc3be-171">Windows PowerShell プログラマー ガイド</span><span class="sxs-lookup"><span data-stu-id="bc3be-171">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="bc3be-172">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="bc3be-172">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)
